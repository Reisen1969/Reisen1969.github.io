{"posts":[{"title":"draft","text":"riscv 内核系统调用定义的文件 linux/include/uapi/asm-generic/unistd.h 为riscv内核添加系统调用的方法直接把 diff 打出来看看. 1234567891011121314151617181920212223242526272829303132333435363738394041424344diff --git a/include/linux/syscalls.h b/include/linux/syscalls.hindex 33a0ee3bcb2e..b40451a71d49 100644--- a/include/linux/syscalls.h+++ b/include/linux/syscalls.h@@ -783,6 +783,7 @@ asmlinkage long sys_adjtimex_time32(struct old_timex32 __user *txc_p); /* kernel/sys.c */ asmlinkage long sys_getpid(void);+asmlinkage long sys_chippy(void); asmlinkage long sys_getppid(void); asmlinkage long sys_getuid(void); asmlinkage long sys_geteuid(void);diff --git a/include/uapi/asm-generic/unistd.h b/include/uapi/asm-generic/unistd.hindex 45fa180cc56a..fe7209caf314 100644--- a/include/uapi/asm-generic/unistd.h+++ b/include/uapi/asm-generic/unistd.h@@ -520,6 +520,8 @@ __SC_3264(__NR_adjtimex, sys_adjtimex_time32, sys_adjtimex) /* kernel/sys.c */ #define __NR_getpid 172 __SYSCALL(__NR_getpid, sys_getpid)+#define __NR_chippy 400+__SYSCALL(__NR_chippy, sys_chippy) #define __NR_getppid 173 __SYSCALL(__NR_getppid, sys_getppid) #define __NR_getuid 174diff --git a/kernel/sys.c b/kernel/sys.cindex 339fee3eff6a..0474a8676476 100644--- a/kernel/sys.c+++ b/kernel/sys.c@@ -954,6 +954,12 @@ SYSCALL_DEFINE0(getpid) return task_tgid_vnr(current); }+SYSCALL_DEFINE0(chippy)+{+ printk(&quot;chippy !!\\r\\n&quot;);+ return task_tgid_vnr(current);+}+ /* Thread ID - the internal kernel &quot;pid&quot; */ SYSCALL_DEFINE0(gettid) { 000strace 工具可根据程序的名称输出系统调用的过程 ltrace工具显示出了程序在用户空间的调用 启动方式","link":"/2023/08/27/draft/"},{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","link":"/2024/01/07/hello-world/"},{"title":"使用hexo","text":"使用hexo的一些记录 建站123$ hexo init &lt;folder&gt;$ cd &lt;folder&gt;$ npm install 这个文件夹/主目录 作为 main 分支的文件夹, 我打算将gh-pages作为我的主页面. 一些快捷命令1$ hexo server 生成网站并本地预览 1$ hexo deploy 可以一件部署到github需要事先 在 _config.yml添加 12345deploy: type: git repo: https://github.com/&lt;username&gt;/&lt;project&gt; # example, https://github.com/hexojs/hexojs.github.io branch: gh-pages 在 主目录执行 1npm install hexo-deployer-git --save 安装git插件. 1hexo new post tmp 新建一篇post github自动化处理使用 node –version 指令检查你电脑上的 Node.js 版本，并记下该版本在储存库中建立 .github/workflows/pages.yml，并填入以下内容 (将 16 替换为上个步骤中记下的版本)： 1234567891011121314151617181920212223242526272829303132333435.github/workflows/pages.ymlname: Pageson: push: branches: - main # default branchjobs: pages: runs-on: ubuntu-latest permissions: contents: write steps: - uses: actions/checkout@v2 - name: Use Node.js 16.x uses: actions/setup-node@v2 with: node-version: &quot;16&quot; - name: Cache NPM dependencies uses: actions/cache@v2 with: path: node_modules key: ${{ runner.OS }}-npm-cache restore-keys: | ${{ runner.OS }}-npm-cache - name: Install Dependencies run: npm install - name: Build run: npm run build - name: Deploy uses: peaceiris/actions-gh-pages@v3 with: github_token: ${{ secrets.GITHUB_TOKEN }} publish_dir: ./public 主题在 blog/_config.yml 文件中找到并修改： theme: volantis 在主目录执行 npm i hexo-theme-volantis 更新主题:更新时，把 package.json 中的版本号改为 * 再执行 npm i 就可以了。 自定义设置","link":"/2024/01/07/hexo/"},{"title":"一些乐理知识","text":"基本知识唱名: do re mi fa so la xi音名: C D E F G A B 度:do 到 re 是 2 度 大调更开心喜悦 全 全 半 全 全 全 半C D E F G A B C 小调更忧伤一些全半全全半全全 3 6 7 减半音就可以了 一些其他音阶中国民族音: 1 2 3 5 6 和风 3 4 6 7 1 / 3 4 6 7 2 和弦从根音到冠音之间的距离 三和弦 七和弦 节拍44拍, 4分音符为一拍, 每小时4拍 五线谱带b的位置下降一个调. 高音谱号 G, 用来定位中央G的位置 G4 低音谱号 F, 定位低音F的位置 F3 https://zhuanlan.zhihu.com/p/31864712 升 #降 b","link":"/2024/01/07/music/"},{"title":"启动riscv内核","text":"在这里只是记录一下,方便以后查阅 本文的内容来源 riscv官方网页 解决文件系统问题 编译busybox 9p 获取源码123git clone https://github.com/qemu/qemugit clone https://github.com/torvalds/linuxgit clone https://git.busybox.net/busybox 编译qemu12./configure --target-list=riscv64-softmmu --enable-virtfsmake -j $(nproc) 编译kernel123456789101112//这里设置的工具链,以自己环境里的为准//生成配置文件make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- defconfig//开始编译make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- -j $(nproc)//编译方法2 make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- defconfig make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- menuconfig make -j $(nproc) ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- vmlinux 编译Busybox12345make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- defconfigmake ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- menuconfig//Check Settings - Build static binary (no shared libs)make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- install CONFIG_PREFIX=./rootfs//这里选择将busybox安装到本目录下的./rootfs文件夹下 制作根文件系统1234567891011121314151617//制作文件系统$ cd youer_workspacemkdir rootfs$ cd rootfs$ dd if=/dev/zero of=rootfs.img bs=1M count=50$ mkfs.ext2 -L riscv-rootfs rootfs.img//将它挂载到 mnt/rootfs$ sudo mkdir /mnt/rootfs$ sudo mount rootfs.img /mnt/rootfs//将busybox编译出来的内容复制到rootfs.img文件系统中$ sudo cp -ar your_busybox/rootfs/* /mnt/rootfs//创建根目录$ sudo mkdir /mnt/rootfs/{dev,home,mnt,proc,sys,tmp,var}$ sudo chown -R -h root:root /mnt/rootfs 12345678910//检查文件系统$ df /mnt/rootfsFilesystem 1K-blocks Used Available Use% Mounted on/dev/loop5 49584 1704 45320 4% /mnt/rootfs$ mount | grep rootfsriscv64-linux/rootfs/rootfs.img on /mnt/rootfs type ext2 (rw,relatime)//卸载文件系统$ sudo umount /mnt/rootfs$ sudo rmdir /mnt/rootfs 使用根文件系统启动内核123456qemu-system-riscv64 -nographic -machine virt \\ -kernel linux/arch/riscv/boot/Image -append &quot;root=/dev/vda ro console=ttyS0&quot; \\ -drive file=your_rootfs.img,format=raw,id=hd0 \\ -device virtio-blk-device,drive=hd0 \\ -fsdev local,id=p9fs,path=./share,security_model=mapped \\-device virtio-9p-pci,fsdev=p9fs,mount_tag=p9 挂载共享目录1mount p9 -t 9p /mnt","link":"/2024/01/07/riscv/"},{"title":"记录一下自己使用的vim配置和插件","text":"fzf插件12Plug 'junegunn/fzf', { 'dir': '~/.fzf', 'do': './install --all' }Plug 'junegunn/fzf.vim' 1nnoremap &lt;silent&gt; &lt;c-p&gt; :Files &lt;CR&gt; 全范围搜索文件名 airline主题12Plug 'vim-airline/vim-airline'Plug 'vim-airline/vim-airline-themes' 目录栏插件Plug ‘preservim/nerdtree’, { ‘on’: ‘NERDTreeToggle’ }","link":"/2023/07/08/vim-plugin/"},{"title":"wsl2设置sd卡","text":"微软参考 重新编译wsl内核原版的wsl不带sd卡的驱动, 需要重新编译内核 仓库 https://github.com/microsoft/WSL2-Linux-Kernel.git 12sudo apt install build-essential flex bison libssl-dev libelf-dev dwarvesmake menuconfig KCONFIG_CONFIG=Microsoft/config-wsl 打开 Device Driver-&gt;USB support Support for Host-side USB 和 USB Mass Storage support 1make -j$(nproc) bzImage KCONFIG_CONFIG=Microsoft/config-wsl 编译出的文件是 arch/x86/boot/bzImage 然后更改 wsl2的配置文件 .wslconfig 加入以下 12[wsl2]kernel=C:\\\\kernel\\\\bzImage_sd windows安装 USBIPD-WIN https://github.com/dorssel/usbipd-win wsl12sudo apt install linux-tools-generic hwdatasudo update-alternatives --install /usr/local/bin/usbip usbip /usr/lib/linux-tools/*-generic/usbip 20 使用方法在windows下执行 123456789usbipd wsl listBUSID VID:PID DEVICE STATE1-9 8087:0029 英特尔(R) 无线 Bluetooth(R) Not attached1-10 0b05:19af AURA LED Controller, USB 输入设备 Not attached1-11 14cd:1212 USB 大容量存储设备 Not attached4-2 046a:c122 USB 输入设备 Not attached4-3 18f8:1286 USB 输入设备 Not attached 找到sd卡的编号 然后执行 1usbipd wsl attach --busid 1-11 然后就能在wsl2 里看到 sd卡了","link":"/2023/10/02/wsl2_sd_card/"},{"title":"wsl2终端代理设置","text":"wsl2终端代理设置 12345678910111213141516171819202122232425262728293031323334353637383940414243444546hostip=$(cat /etc/resolv.conf | grep nameserver | awk '{ print $2 }')wslip=$(hostname -I | awk '{print $1}')port=10809PROXY_HTTP=&quot;http://${hostip}:${port}&quot;echo $PROXY_HTTPexport http_proxy=&quot;${PROXY_HTTP}&quot;export HTTP_PROXY=&quot;${PROXY_HTTP}&quot;export https_proxy=&quot;${PROXY_HTTP}&quot;export HTTPS_proxy=&quot;${PROXY_HTTP}&quot;export ALL_PROXY=&quot;${PROXY_SOCKS5}&quot;export all_proxy=&quot;${PROXY_SOCKS5}&quot;git config --global http.https://github.com.proxy ${PROXY_HTTP}git config --global https.https://github.com.proxy ${PROXY_HTTP}echo &quot;Proxy has been opened.&quot;test_proxy(){ echo &quot;Host IP:&quot; ${hostip} echo &quot;WSL IP:&quot; ${wslip} echo &quot;Try to connect to Google...&quot; resp=$(curl -I -s --connect-timeout 5 -m 5 -w &quot;%{http_code}&quot; -o /dev/null www.google.com) if [ ${resp} = 200 ]; then echo &quot;Proxy setup succeeded!&quot; else echo &quot;Proxy setup failed!&quot; fi}unset_proxy(){ unset http_proxy unset HTTP_PROXY unset https_proxy unset HTTPS_PROXY unset ALL_PROXY unset all_proxy git config --global --unset http.https://github.com.proxy git config --global --unset https.https://github.com.proxy echo &quot;Proxy has been closed.&quot;}","link":"/2024/01/07/wsl2proxy/"}],"tags":[{"name":"draft","slug":"draft","link":"/tags/draft/"},{"name":"hexo","slug":"hexo","link":"/tags/hexo/"},{"name":"music","slug":"music","link":"/tags/music/"},{"name":"riscv","slug":"riscv","link":"/tags/riscv/"},{"name":"linux","slug":"linux","link":"/tags/linux/"},{"name":"vim","slug":"vim","link":"/tags/vim/"},{"name":"wsl2","slug":"wsl2","link":"/tags/wsl2/"},{"name":"proxy","slug":"proxy","link":"/tags/proxy/"}],"categories":[{"name":"note","slug":"note","link":"/categories/note/"},{"name":"music","slug":"music","link":"/categories/music/"}],"pages":[{"title":"404 Not Found","text":"无法访问！我不能给你变出一个页面来！","link":"/404.html"},{"title":"About me","text":"hello!!","link":"/about/index.html"}]}